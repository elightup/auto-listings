(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,n=JSON.parse('{"UU":"meta-box/submission-form"}'),o=window.React,l=window.wp.blockEditor,s=window.wp.components,a=window.wp.data,i=window.wp.element,r=window.wp.hooks,b=window.wp.i18n,m=window.wp.serverSideRender;var u=e.n(m);(0,t.registerBlockType)(n.UU,{edit:function({attributes:e,setAttributes:t}){const n=(0,i.useRef)();let{meta_box_id:m,id:d,ajax:_,allow_scroll:c,edit:f,allow_delete:p,force_delete:h,show_add_more:g,post_type:C,object_type:w="post",object_id:x,post_id:E,post_status:v,post_fields:y,label_title:T,label_content:k,label_excerpt:j,label_date:O,label_thumbnail:S,submit_button:A,add_button:D,delete_button:F,redirect:P,confirmation:B,delete_confirmation:U,recaptcha_key:M,recaptcha_secret:R}=e;const I=Object.keys(mbfsData.post_statuses).map(e=>({label:e,value:e})),L=e=>n=>t({[e]:n});0===d.length&&m&&(d=m.split(",")),d=d.filter(e=>mbfsData.field_groups.some(t=>t.value===e));const q=mbfsData.field_groups.filter(e=>d.includes(e.value)),G=mbfsData.post_types.filter(e=>q.some(t=>t.post_types.includes(e.value))),J=mbfsData.object_types.filter(e=>q.some(t=>t.object_type===e.value)),N=q.flatMap(e=>e.fields),W={post_title:"title",post_content:"content",post_excerpt:"excerpt",post_date:"date",_thumbnail_id:"thumbnail"},z=N.filter(e=>W[e]).map(e=>W[e]),H=["title","content","excerpt","date","thumbnail"].filter(e=>!z.includes(e));return(0,i.useEffect)(()=>{1===J.length&&t({object_type:J[0].value})},[J]),(0,i.useEffect)(()=>{1===G.length&&t({post_type:G[0].value})},[G]),(0,i.useEffect)(()=>{const e=(0,a.subscribe)(()=>{const t=n?.current?.querySelector(".rwmb-field");t&&((0,r.doAction)("mb_ready",n.current),e())});return()=>{e()}},[]),(0,o.createElement)("div",{...(0,l.useBlockProps)({ref:n})},(0,o.createElement)(l.InspectorControls,null,(0,o.createElement)(s.PanelBody,{title:(0,b.__)("Settings","mb-frontend-submission")},(0,o.createElement)(s.FormTokenField,{__experimentalAutoSelectFirstMatch:!0,__experimentalExpandOnFocus:!0,label:(0,b.__)("Field group","mb-frontend-submission"),value:d,onChange:L("id"),suggestions:mbfsData.field_groups,saveTransform:e=>e?.value||"",displayTransform:e=>mbfsData.field_groups.find(t=>t.value===("string"==typeof e?e:e.value))?.label||""}),(0,o.createElement)(s.ToggleControl,{label:(0,b.__)("Enable ajax submission","mb-frontend-submission"),checked:_,onChange:L("ajax")}),(0,o.createElement)(s.ToggleControl,{label:(0,b.__)("Allow to edit after submitting","mb-frontend-submission"),help:(0,b.__)("If enabled, then ajax submission will be disabled.","mb-frontend-submission"),checked:f,onChange:L("edit")}),(0,o.createElement)(s.ToggleControl,{label:(0,b.__)("Allow to delete the entry","mb-frontend-submission"),help:(0,b.__)("Allow users to delete the submitted entry.","mb-frontend-submission"),checked:p,onChange:L("allow_delete")}),"post"===w&&p&&(0,o.createElement)(s.ToggleControl,{label:(0,b.__)("Force delete","mb-frontend-submission"),help:(0,b.__)("Whether to delete the submitted entry permanently or temporarily (move to Trash).","mb-frontend-submission"),checked:h,onChange:L("force_delete")}),(0,o.createElement)(s.ToggleControl,{label:(0,b.__)("Allow to add more entries","mb-frontend-submission"),checked:g,onChange:L("show_add_more")}),J.length>1&&(0,o.createElement)(s.SelectControl,{label:(0,b.__)("Object type","mb-frontend-submission"),value:w,options:J,onChange:L("object_type")}),(0,o.createElement)(s.TextControl,{label:(0,b.__)("Object ID","mb-frontend-submission"),help:(0,b.__)("The object id, used when you want to update an existing entry.","mb-frontend-submission"),value:x,onChange:L("object_id")}),"post"===w&&(0,o.createElement)(o.Fragment,null,G.length>1&&(0,o.createElement)(s.SelectControl,{label:(0,b.__)("Post type","mb-frontend-submission"),value:C,options:[{label:(0,b.__)("-","mb-frontend-submission"),value:""},...G],onChange:L("post_type")}),(0,o.createElement)(s.SelectControl,{label:(0,b.__)("Post status","mb-frontend-submission"),value:v,options:[{label:"-",value:""},...I],onChange:L("post_status")}),H.length>0&&(0,o.createElement)(s.FormTokenField,{__experimentalAutoSelectFirstMatch:!0,__experimentalExpandOnFocus:!0,label:(0,b.__)("Post fields","mb-frontend-submission"),help:(0,b.__)("List of post fields you want to show in the frontend.","mb-frontend-submission"),value:y,suggestions:H,onChange:L("post_fields")})),(0,o.createElement)(s.TextControl,{label:(0,b.__)("Custom redirect URL","mb-frontend-submission"),value:P,onChange:L("redirect")})),(0,o.createElement)(s.PanelBody,{title:(0,b.__)("Appearance","mb-frontend-submission"),initialOpen:!1},(0,o.createElement)(s.ToggleControl,{label:(0,b.__)("Allow scroll","mb-frontend-submission"),help:(0,b.__)("Enable scroll to the message after ajax submission.","mb-frontend-submission"),checked:c,onChange:L("allow_scroll")}),(0,o.createElement)(s.TextControl,{label:(0,b.__)("Confirmation text","mb-frontend-submission"),help:(0,b.__)("The text for the confirmation message when the form is successfully submitted.","mb-frontend-submission"),value:B,onChange:L("confirmation")}),(0,o.createElement)(s.TextControl,{label:(0,b.__)("Delete confirmation text","mb-frontend-submission"),help:(0,b.__)("The text for the confirmation message when the entry is deleted.","mb-frontend-submission"),value:U,onChange:L("delete_confirmation")}),(0,o.createElement)(s.TextControl,{label:(0,b.__)("Submit button text","mb-frontend-submission"),value:A,onChange:L("submit_button")}),(0,o.createElement)(s.TextControl,{label:(0,b.__)("Add new button text","mb-frontend-submission"),value:D,onChange:L("add_button")}),(0,o.createElement)(s.TextControl,{label:(0,b.__)("Delete button text","mb-frontend-submission"),value:F,onChange:L("delete_button")})),"post"===w&&y.length>0&&(0,o.createElement)(s.PanelBody,{title:(0,b.__)("Post fields labels","mb-frontend-submission"),initialOpen:!1},y.includes("title")&&(0,o.createElement)(s.TextControl,{label:(0,b.__)("Title","mb-frontend-submission"),value:T,onChange:L("label_title")}),y.includes("content")&&(0,o.createElement)(s.TextControl,{label:(0,b.__)("Content","mb-frontend-submission"),value:k,onChange:L("label_content")}),y.includes("excerpt")&&(0,o.createElement)(s.TextControl,{label:(0,b.__)("Excerpt","mb-frontend-submission"),value:j,onChange:L("label_excerpt")}),y.includes("date")&&(0,o.createElement)(s.TextControl,{label:(0,b.__)("Date","mb-frontend-submission"),value:O,onChange:L("label_date")}),y.includes("thumbnail")&&(0,o.createElement)(s.TextControl,{label:(0,b.__)("Thumbnail","mb-frontend-submission"),value:S,onChange:L("label_thumbnail")})),(0,o.createElement)(s.PanelBody,{title:(0,b.__)("Google reCaptcha (v3)","mb-frontend-submission"),initialOpen:!1},(0,o.createElement)(s.TextControl,{label:(0,b.__)("Site key","mb-frontend-submission"),value:M,onChange:L("recaptcha_key")}),(0,o.createElement)(s.TextControl,{label:(0,b.__)("Secret key","mb-frontend-submission"),value:R,onChange:L("recaptcha_secret")}))),(0,o.createElement)(u(),{block:"meta-box/submission-form",attributes:e}))},save:function(){return null}})})();